@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@using GymHub.Data.Models
@model ProductInfoViewModel
@{
}

@section AdditionalLinks{
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link href="~/css/ProductPageForOnlineShop.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!------ Include the above in your HEAD tag ---------->
}

<div class="container-fluid">
    <div class="content-wrapper">
        <div class="item-container">
            <div class="container" style="padding-top:10px;">
                <div class="col-md-12">
                    <div class="product col-md-3 service-image-left">

                        <center>
                            <img id="item-display" src="/ProductsImages/@Model.MainImage" alt="">
                        </center>
                    </div>

                    <div class="container service1-items col-sm-2 col-md-2 pull-left">
                        <center>
                            <a id="item-1" class="service1-item">
                                <img src="http://www.corsair.com/Media/catalog/product/g/s/gs600_psu_sideview_blue_2.png" alt="">
                            </a>
                            <a id="item-2" class="service1-item">
                                <img src="http://www.corsair.com/Media/catalog/product/g/s/gs600_psu_sideview_blue_2.png" alt="">
                            </a>
                            <a id="item-3" class="service1-item">
                                <img src="http://www.corsair.com/Media/catalog/product/g/s/gs600_psu_sideview_blue_2.png" alt="">
                            </a>
                        </center>
                    </div>
                </div>

                <div class="col-md-7">
                    <div class="product-title">@Model.Name: @Model.Model</div>
                    <div class="product-desc">@Model.ShortDescription</div>
                    <div class="product-rating">
                        @{
                            var productRating = Model.ProductRating;
                        }
                        @for (int i = 0; i < productRating.FullStarsCount; i++)
                        {
                            <i class="fa fa-star gold"></i>
                        }
                        @if (productRating.HasHalfStar == true)
                        {
                            <i class="fa fa-star-half-o gold"></i>
                        }
                        @for (int i = 0; i < productRating.EmptyStarsCount; i++)
                        {
                            <i class="fa fa-star-o gold"></i>
                        }
                        <span> @productRating.AverageRating/10</span>
                    </div>
                    <hr>
                    <div class="product-price">$ @Model.Price</div>
                    <div class="product-stock">In Stock: @Model.QuantityInStock</div>
                    <hr>
                    <div class="btn-group cart">
                        <form method="post">
                            <input type="hidden" name="productId" value="@Model.Id" />
                            <input type="hidden" name="quantity" value="1" />
                            <button asp-controller="Carts" asp-action="AddToCart" type="submit" class="btn btn-success">
                                Add
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="col-md-12 product-info">
                <ul id="myTab" class="nav nav-tabs nav_tabs">

                    <li class="active"><a href="#service-one" data-toggle="tab">Product info</a></li>
                    <li><a href="#service-two" data-toggle="tab">User reviews</a></li>

                </ul>
                <div id="myTabContent" class="tab-content">
                    <div class="tab-pane fade in active" id="service-one" name="service-one">

                        <section class="container product-info">
                            @Model.Description
                        </section>

                    </div>
                    <div class="tab-pane fade" id="service-two" name="service-two">

                        <section class="container" style="margin-top: 10px;">
                            <form class="product-comment-addReview-form-container">
                                <textarea class="input-group"></textarea>
                                <button asp-controller="Carts" asp-action="AddToCart" type="submit" class="form-check btn btn-success product-comment-addReview-button">Add review</button>
                            </form>
                            <hr />
                            @foreach (var kv in Model.ParentsChildrenComments)
                            {
                                var parentComment = kv.Key;
                                var childrenComments = kv.Value;
                                if (parentComment.ParentCommentId == null)
                                {
                                    var userProductRating = Model.UsersProductRatings[parentComment.User];
                                    var repliesCount = childrenComments.Count;
                                    <div class="product-commentWithChildren-container">
                                        @await Html.PartialAsync("_ProductCommentPartial.cshtml", new ProductCommentPartialViewModel(parentComment, userProductRating, repliesCount))
                                        <div hidden class="product-comment-child-container">
                                            @foreach (var childComment in childrenComments)
                                            {
                                                var userProductRatingChild = Model.UsersProductRatings[childComment.User];
                                                @await Html.PartialAsync("_ProductCommentPartial.cshtml", new ProductCommentPartialViewModel(childComment, userProductRatingChild))
                                            }
                                        </div>
                                    </div>
                                }
                            }
                        </section>

                    </div>
                </div>
                <hr>
            </div>
        </div>
    </div>
</div>
@section Scripts{
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.1/js/bootstrap.min.js" asp-append-version="true"></script>
    <script src="//code.jquery.com/jquery-1.11.1.min.js" asp-append-version="true"></script>
    <script src="/js/ProductCommentsReplyButton.js"></script>
}
